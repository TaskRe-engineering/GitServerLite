#!/bin/bash

#for debugging
#set -ex

#
# Copyright Â© 2023 Task Re-engineering Inc.
# All rights reserved.
# 
# This source code is licensed under the [] license found in the
# LICENSE file in the root directory of this source tree. 
#

## Usage: gitserverlite <command> [<arguments>]
##
## Commands:
##   add-branch <branch name>       Adds as branch to automatic deployment
##   remove-branch <branch name>    Removes a branch from automatic deployment
##   list                           Lists all branches that will automatically deploy
##   show-branch <branch name>      Prints the automatic deployment parameters for a branch
##   show-deploy-location           Prints the path to the directory where the repository files are deployed
##   version                        Prints the installed version
##   help                           Print this help

shopt -s nullglob

command="$1"
argument1="$2"

GSL_DIR=".gitserverlite"

source "$GSL_DIR/env"
source "$GSL_DIR/gsl-io"
source "$GSL_DIR/gsl-manage"
source "$GSL_DIR/version"

GSL_DEPLOY_BRANCHES_DIR="$GSL_DIR/deploy_branches"
get_branches

(run_selection "$command" "$argument1")
exit_status=$?
if [[ $exit_status -ne 0 ]];
then
    print_invalid_command
fi
